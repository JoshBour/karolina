$(function(){function a(){var a=$("#infoWrapper");if(t.hasClass("homePage")){var e=s.height()-$("header").outerHeight()-$("#posts").outerHeight(!0);a.css("height",e)}a.backstretch(baseUrl+"/images/home-background.jpg"),$(".sideBackground").height(a.height())}var e,t=$("body"),i=$("#flash"),s=$(window);i.is(":visible")&&i.setRemoveTimeout(3e3),$(".printTrigger").on("click",function(a){a.preventDefault(),window.print()}),$(document).on("click",function(a){"shadow"==a.target.id&&(e.unfocusLight(),$("body").removeClass("unscrollable"),e.detach())}),a(),s.on("resize",a);var r=$(".tabs span");r.each(function(){var a=$(this),e=a.attr("class").split(" ")[0].substr(4);a.hasClass("activeTab")?$("#"+e).show():$("#"+e).hide()}),r.on("click",function(){var a=$(this);if(!a.hasClass("activeTab")){var e=a.siblings(".activeTab").removeClass("activeTab");$("#"+e.attr("class").split(" ")[0].substr(4)).fadeOut("normal",function(){$("#"+a.attr("class").split(" ")[0].substr(4)).fadeIn()}),a.addClass("activeTab")}});var n=!1,o=$("#categories").html();$(".search input").on("keyup",function(a){var e=$(this).val().trim().toLowerCase();delay(function(){if(a.preventDefault(),!n){n=!0;var t=$("#categories");0==e.length?t.html(o):e.length>1&&$.ajax({url:baseUrl+"/products/search/"+e,type:"GET"}).success(function(a){""!=$.trim(a)&&t.html(a)}).error(function(){addMessage("Something with wrong, please try again.")}),n=!1}},150)}),$(".magnifiable").on("click",function(){var a=$(this),i=a.attr("src"),s=$(window).height(),r=$("<img />",{src:i,css:{display:"none"}}).appendTo(t),n=r.height();if(r.remove(),s-100>n)var o={top:"50%",marginTop:-parseInt(n/2)};else var o={top:0,marginTop:"50px"};var c=$("<div/>",{id:"stageWrapper",css:o}).prependTo($("body")),h=$("<div/>",{id:"stage"}).appendTo(c),l=$("<div/>",{id:"imageWrapper"}).appendTo(h),d=$("<img/>",{src:i,css:{"max-height":$(window).height()-100,width:"auto"}}).appendTo(l);e=c,c.focusLight(),c.css({width:d.width(),"margin-left":-(d.width()/2)}),t.addClass("unscrollable")})});