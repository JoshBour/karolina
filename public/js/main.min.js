function addMessage(a){var b=$(".flash");b.is(":visible")?b.html(a):b=$("<div></div>",{"class":"flash",text:a,css:{display:"none"}}).prependTo("body").slideDown("slow"),b.setRemoveTimeout(5e3)}var delay=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}();!function(a){a.fn.setRemoveTimeout=function(b){var c=a(this);return c.length>0&&setTimeout(function(){a(c).slideUp("slow",function(){a(this).detach()})},b),c}}(jQuery),function(a){a.fn.focusLight=function(){var b=a(this);return a("<div />",{id:"shadow"}).appendTo("body"),b.addClass("focused"),b}}(jQuery),function(a){a.fn.unfocusLight=function(){var b=a(this);return a("#shadow").detach(),b.removeClass("focused"),b}}(jQuery),$(function(){function a(){var a=$("#infoWrapper"),b=(a.height(),e.height());if(c.hasClass("homePage")){var d=$("#posts").outerHeight(!0),f=b-60-d-15;a.css("height",f)}$(".sideBackground").height(a.height())}var b,c=$("body"),d=$("#flash"),e=$(window);d.is(":visible")&&d.setRemoveTimeout(3e3),$(".printTrigger").on("click",function(a){a.preventDefault(),window.print()}),$(document).on("click",function(a){"shadow"==a.target.id&&(b.unfocusLight(),$("body").removeClass("unscrollable"),b.detach())}),$("#menuIcon").on("click",function(a){$(this).siblings("nav").slideToggle()}),e.on("resize",function(){e.width()>1280&&$("#topWrapper nav").show()}),a(),e.on("resize",a);var f=$(".tabs span");f.each(function(){var a=$(this),b=a.attr("class").split(" ")[0].substr(4);a.hasClass("activeTab")?$("#"+b).show():$("#"+b).hide()}),f.on("click",function(){var a=$(this);if(!a.hasClass("activeTab")){var b=a.siblings(".activeTab").removeClass("activeTab");$("#"+b.attr("class").split(" ")[0].substr(4)).fadeOut("normal",function(){$("#"+a.attr("class").split(" ")[0].substr(4)).fadeIn()}),a.addClass("activeTab")}});var g=!1,h=$("#categories").html();$(".search input").on("keyup",function(a){var b=$(this).val().trim().toLowerCase();delay(function(){if(a.preventDefault(),!g){g=!0;var c=$("#categories");0==b.length?c.html(h):b.length>1&&$.ajax({url:baseUrl+"/products/search/"+b,type:"GET"}).success(function(a){""!=$.trim(a)&&c.html(a)}).error(function(){addMessage("Something with wrong, please try again.")}),g=!1}},150)});var i=$("#imagePreview");if(i.length>0){var j=i.find("img");j.css("max-width",j.get(0).naturalWidth)}$("#images").find("ul li").click(function(){var a=$(this);if(!a.hasClass("active")){var b=$("#imagePreview"),d=b.find("img");d.css("height",d.height()).attr("src",baseUrl+"/public/images/loading.gif"),a.siblings(".active").removeClass("active"),a.addClass("active");var e=a.children("img").attr("src").split("/"),f=e[e.length-1].slice(0,-12),g=baseUrl+"/public/images/gallery/"+f+".png",h=$("<img />",{src:g}).hide().appendTo(c).load(function(){d.css("max-width",h.width()),h.remove(),d.css("height","auto").attr("src",g),b.children("span").text(a.children("span").text())})}}),$(".magnifiable").on("click",function(){var a=$(this),d=a.attr("src"),e=$(window).height(),f=$("<img />",{src:d,css:{display:"none"}}).appendTo(c),g=f.height();if(f.remove(),e-100>g)var h={top:"50%",marginTop:-parseInt(g/2)};else var h={top:0,marginTop:"50px"};var i=$("<div/>",{id:"stageWrapper",css:h}).prependTo($("body")),j=$("<div/>",{id:"stage"}).appendTo(i),k=$("<div/>",{id:"imageWrapper"}).appendTo(j),l=$("<img/>",{src:d,css:{"max-height":$(window).height()-100,width:"auto"}}).appendTo(k);b=i,i.focusLight(),i.css({width:l.width(),"margin-left":-(l.width()/2)}),c.addClass("unscrollable")})});